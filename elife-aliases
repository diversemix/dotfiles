alias pb="npx pubsweet server"
alias node_clean="find . -type d -name 'node_modules' -exec rm -rf {} \;"
alias db_rebuild="docker stop elifexpub_postgres_1; docker rm -v elifexpub_postgres_1; docker volume rm elifexpub_postgres-volume; dc up -d postgres"

alias clean_stg="ssh elife@staging--xpub.elifesciences.org \"docker images | grep days | grep xpub| cut -d ' ' -f9 | xargs docker rmi\""

# AWS
alias ssh_stg="ssh -L 50000:elife-xpub-staging.cxyopn44uqbl.us-east-1.rds.amazonaws.com:5432 elife@54.158.11.12"
alias ssh_ci="ssh elife@ci--xpub.elifesciences.org"
alias ssh_prod="ssh -L 50001:elife-xpub-prod.cxyopn44uqbl.us-east-1.rds.amazonaws.com:5432 elife@prod--xpub.elifesciences.org"

# eLife
alias pr='browse_to https://github.com/elifesciences/elife-xpub/pull/'
alias issue='browse_to https://github.com/elifesciences/elife-xpub/issues/'

# Example : $ compare <branch>
alias compare='browse_to https://github.com/elifesciences/elife-xpub/compare/develop...' 
alias el="cd ~/dev/elife-xpub"

export GIT_TOKEN=$(cat ~/dotfiles/git_token)

xpub_prs() {
	curl -s https://api.github.com/repos/elifesciences/elife-xpub/pulls?state=open > /tmp/open
	cat /tmp/open | jq '.[] | {title: .title, url: .html_url, name: .user.login }'
	#cat /tmp/open | cut -d " " -f5- | grep "^\"title\"" | cut -d "\"" -f4 | cut -c 1-30 > /tmp/open_titles
	#cat /tmp/open | cut -d " " -f5- | grep "^\"html_url\"" | cut -d "\"" -f4 > /tmp/open_urls
	#cat /tmp/open | cut -d " " -f7- | grep "^\"login\"" | cut -d "\"" -f4 > /tmp/open_user
	#echo ${BLUE} ;paste /tmp/open_titles /tmp/open_urls /tmp/open_user
	#echo ""
}

xpub_project() {
	curl -H "Authorization: token ${TOKEN}" -H "Accept: application/vnd.github.inertia-preview+json" https://api.github.com/repos/elifesciences/elife-xpub/projects
	curl -H "Authorization: token ${TOKEN}" -H "Accept: application/vnd.github.inertia-preview+json" https://api.github.com/projects/1391224
}
